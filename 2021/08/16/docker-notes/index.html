<!DOCTYPE html><html lang="zh_CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Docker笔记 | 妙妙屋</title><script src="https://cdn.bootcss.com/valine/1.4.4/Valine.min.js"></script><script src="https://cdn.bootcdn.net/ajax/libs/mermaid/8.11.0/mermaid.min.js"></script><script>mermaid.initialize({
  startOnLoad: true
  , theme: 'dark'
});</script><link rel="stylesheet" href="/css/arknights.css"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/highlight.js/10.1.2/styles/atom-one-dark-reasonable.min.css"><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><meta name="generator" content="Hexo 5.4.0"></head><body><header><nav><a href="/">主页</a><a href="/archives/">文章</a><a href="/about/">关于</a><a href="/contact/">联系</a></nav></header><main><article><div id="post-bg"><div id="post-title"><h1>Docker笔记</h1><hr></div><div id="post-content"><h1 id="dockerfiles编写"><a href="#dockerfiles编写" class="headerlink" title="dockerfiles编写"></a>dockerfiles编写</h1><p><strong>FROM</strong>：继承的镜像，docker容器必须要继承一个镜像</p>
<p><strong>MAINTAINER</strong>：维护人员信息 ideask&lt;<a href="mailto:&#105;&#100;&#x65;&#97;&#x73;&#x6b;&#x40;&#111;&#x75;&#116;&#x6c;&#111;&#111;&#107;&#x2e;&#99;&#111;&#109;">&#105;&#100;&#x65;&#97;&#x73;&#x6b;&#x40;&#111;&#x75;&#116;&#x6c;&#111;&#111;&#107;&#x2e;&#99;&#111;&#109;</a>&gt;</p>
<p><strong>ENV</strong>:需要配置环境变量</p>
<p><strong>RUN</strong>：后面是执行的命令</p>
<p><strong>EXPOSE</strong>：声明需要维护的端口，用处不大，但是对镜像使用者进行提醒</p>
<p><strong>CMD</strong>：通过CMD指令指定容器启动时要执行的命令，执行路径！！记得设置，譬如要下载和解压文件，必须指定路径而且&amp;&amp;并着来执行，不然路径会出错！！！！！</p>
<p><strong>Volume</strong> : 要挂载的目录</p>
<p><strong>COPY</strong>:命令用于将于Dockerfile所在目录中的文件在镜像构建阶段从宿主机拷贝到镜像中，对于文件而言可以直接将文件复制到镜像中</p>
<p><strong>ADD</strong>:命令相对于COPY命令，可以解压缩文件并把它们添加到镜像中的功能，如果我们有一个压缩文件包，并且需要把这个压缩包中的文件添加到镜像中。需不需要先解开压缩包然后执行 COPY 命令呢？当然不需要！我们可以通过 ADD 命令一次搞定</p>
<h1 id="docker-build"><a href="#docker-build" class="headerlink" title="docker build"></a>docker build</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker build -f bbb-ubuntu14-sshd -t bbb-ubuntu14-sshd-env:1.0 .<br></code></pre></td></tr></table></figure>
<h1 id="docker-commit"><a href="#docker-commit" class="headerlink" title="docker commit"></a>docker commit</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]]<br>OPTIONS说明：<br>-a :提交的镜像作者；<br>-c :使用Dockerfile指令来创建镜像；<br>-m :提交时的说明文字；<br>-p :在commit时，将容器暂停。<br><br>runoob@runoob:~$ docker commit -a <span class="hljs-string">&quot;runoob.com&quot;</span> -m <span class="hljs-string">&quot;my apache&quot;</span> a404c6c174a2  mymysql:v1 <br>sha256:37af1236adef1544e8886be23010b66577647a40bc02c0885a6600b33ee28057<br>runoob@runoob:~$ docker images mymysql:v1<br>REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE<br>mymysql             v1                  37af1236adef        15 seconds ago      329 MB<br><br></code></pre></td></tr></table></figure>
<h1 id="docker-images"><a href="#docker-images" class="headerlink" title="docker images"></a>docker images</h1><h2 id="docker-images-history"><a href="#docker-images-history" class="headerlink" title="docker images history"></a>docker images history</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">查看镜像提交历史<br></code></pre></td></tr></table></figure>
<h1 id="docker-ps-docker-ps-a"><a href="#docker-ps-docker-ps-a" class="headerlink" title="docker ps / docker ps -a"></a>docker ps / docker ps -a</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">//查看当前运行的容器<br>docker ps<br>//查看所有容器<br>docker ps -a<br></code></pre></td></tr></table></figure>
<h1 id="docker-stop"><a href="#docker-stop" class="headerlink" title="docker stop"></a>docker stop</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">停止容器<br></code></pre></td></tr></table></figure>
<h1 id="docker-start"><a href="#docker-start" class="headerlink" title="docker start"></a>docker start</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">开启容器<br></code></pre></td></tr></table></figure>
<h1 id="docker-exec"><a href="#docker-exec" class="headerlink" title="docker exec"></a>docker exec</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">在运行的容器里运行某一程序或脚本<br></code></pre></td></tr></table></figure>
<h1 id="docker-rm"><a href="#docker-rm" class="headerlink" title="docker rm"></a>docker rm</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">删除容器<br></code></pre></td></tr></table></figure>
<h1 id="docker-rmi"><a href="#docker-rmi" class="headerlink" title="docker rmi"></a>docker rmi</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">删除容器的镜像<br></code></pre></td></tr></table></figure>
<h1 id="docker-update"><a href="#docker-update" class="headerlink" title="docker update"></a>docker update</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs bash">描述<br>更新一个或多个容器的配置。<br><br>语法<br>docker update [OPTIONS] CONTAINER [CONTAINER...]<br>OPTIONS 说明：<br>--blkio-weight	阻塞IO (相对权重)，介于10到1000之间，0表示禁用（默认禁止）<br>--cpu-period	限制CPU CFS（完全公平的调度程序）期限<br>--cpu-quota	限制CPU CFS（完全公平的调度程序）配额<br>--cpu-rt-period	API 1.25+，将CPU实时时间限制为微秒<br>--cpu-rt-runtime	API 1.25+，将CPU实时运行时间限制为微秒<br>--cpu-shares, -c	CPU份额（相对权重）<br>--cpus	API 1.29+，CPU数量<br>--cpuset-cpus	允许执行的CPU（0-3，0,1）<br>--cpuset-mem	允许执行的MEM（0-3，0,1）<br>--kernel-memory	内核内存限制<br>--memory-swap	交换限制等于内存加交换，“-1”以启用无限交换<br>--memory-reservatio	内存软限制<br>--memory, -m	内存限制<br>--pids-limit	API 1.40+，调节容器pids限制（-1表示无限制）<br>--restart	容器退出时重新启动策略以应用<br><br>实例：<br>1.更新 CPU 共享数量<br><span class="hljs-comment"># f361b7d8465 为 容器ID</span><br>docker update --cpu-shares 512 f361b7d8465<br>2.更新容器的重启策略<br>docker update --restart=always f361b7d8465<br>3.更新容器内存<br>docker update -m 500M f361b7d8465<br><br></code></pre></td></tr></table></figure>
<h1 id="docker-create"><a href="#docker-create" class="headerlink" title="docker create"></a>docker create</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">//创建一个容器暂时不运行，语法同下 run一样<br>//docker create [OPTIONS] IMAGE [COMMAND] [ARG...]<br>//--name 指定一个容器别名<br>//-e 设置环境变量<br>//-v 挂载文件目录<br>//-p 端口映射<br><br>docker create --name=hexo-domain.com \<br>-e HEXO_SERVER_PORT=4000 \<br>-e GIT_USER=<span class="hljs-string">&quot;Your Name&quot;</span> \<br>-e GIT_EMAIL=<span class="hljs-string">&quot;your.email@domain.tld&quot;</span> \<br>-v /blog/domain.com:/app \<br>-p 4000:4000 \<br>spurin/hexo<br></code></pre></td></tr></table></figure>
<h1 id="docker-run"><a href="#docker-run" class="headerlink" title="docker run"></a>docker run</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">// -d 以守护进程运行 -p 指定端口映射宿主机端口：容器端口 <br>docker run -d -p 101:22 bbb-ubuntu14-sshd:1.0<br></code></pre></td></tr></table></figure>
<h1 id="docker-logs"><a href="#docker-logs" class="headerlink" title="docker logs"></a>docker logs</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker logs [OPTIONS] CONTAINER<br>OPTIONS说明：<br><br>-f : 跟踪日志输出<br><br>--since :显示某个开始时间的所有日志<br><br>-t : 显示时间戳<br><br>--tail :仅列出最新N条容器日志<br></code></pre></td></tr></table></figure>

<h1 id="docker导入导出镜像方式"><a href="#docker导入导出镜像方式" class="headerlink" title="docker导入导出镜像方式"></a>docker导入导出镜像方式</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs bash">导入导出命令介绍<br>涉及的命令有<span class="hljs-built_in">export</span>、import、save、load<br>save命令：<br>	docker save [options] images [images...]<br>	示例<br>	docker save -o nginx.tar nginx:latest<br>	或<br>	docker save &gt; nginx.tar nginx:latest<br>	其中-o和&gt;表示输出到文件，nginx.tar为目标文件，nginx:latest是源镜像名（name:tag）<br>load命令：<br>	docker load [options]<br>	示例<br>	docker load -i nginx.tar<br>	或<br>	docker load &lt; nginx.tar<br>	其中-i和&lt;表示从文件输入。会成功导入镜像及相关元数据，包括tag信息<br><span class="hljs-built_in">export</span>命令：<br>	docker <span class="hljs-built_in">export</span> [options] container<br>	示例<br>	docker <span class="hljs-built_in">export</span> -o nginx-test.tar nginx-test<br>	其中-o表示输出到文件，nginx-test.tar为目标文件，nginx-test是源容器名（name）<br>import命令：<br>	docker import [options] file|URL|- [REPOSITORY[:TAG]]<br>	示例<br>	docker import nginx-test.tar nginx:imp<br>	或<br>	cat nginx-test.tar | docker import - nginx:imp<br>区别：<br>	<span class="hljs-built_in">export</span>命令导出的tar文件略小于save命令导出的<br>	<span class="hljs-built_in">export</span>命令是从容器（container）中导出tar文件，而save命令则是从镜像（images）中导出<br>基于第二点，<span class="hljs-built_in">export</span>导出的文件再import回去时，无法保留镜像所有历史（即每一层layer信息，不熟悉的可以去看Dockerfile），不能进行回滚操作；而save是依据镜像来的，所以导入时可以完整保留下每一层layer信息。如下图所示，nginx:latest是save导出load导入的，nginx:imp是<span class="hljs-built_in">export</span>导出import导入的。<br>建议：<br>	可以依据具体使用场景来选择命令，若是只想备份images，使用save、load即可<br>	若是在启动容器后，容器内容有变化，需要备份，则使用<span class="hljs-built_in">export</span>、import<br><br></code></pre></td></tr></table></figure>

<h1 id="常见问题集"><a href="#常见问题集" class="headerlink" title="常见问题集"></a>常见问题集</h1><h2 id="解决：Dockerfile-中执行-tar"><a href="#解决：Dockerfile-中执行-tar" class="headerlink" title="解决：Dockerfile 中执行 tar"></a>解决：Dockerfile 中执行 tar</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">tar (child): xz: Cannot <span class="hljs-built_in">exec</span>: No such file or directory<br>tar (child): Error is not recoverable: exiting now<br>tar: Child returned status 2<br>tar: Error is not recoverable: exiting now<br><br>原因： 没装xz组件<br>解决：<br>apt-get install xz-utils<br></code></pre></td></tr></table></figure>

<h1 id="例子-创建一个ubuntu14带有sshd服务的容器并且部署好开发环境"><a href="#例子-创建一个ubuntu14带有sshd服务的容器并且部署好开发环境" class="headerlink" title="例子-创建一个ubuntu14带有sshd服务的容器并且部署好开发环境"></a>例子-创建一个ubuntu14带有sshd服务的容器并且部署好开发环境</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># BBB builder docker</span><br><span class="hljs-comment"># BBB builder docker</span><br><span class="hljs-comment"># creater by IDEASK</span><br><span class="hljs-comment"># July 27 2021</span><br><span class="hljs-comment"># 继承ubuntu14的镜像</span><br>FROM ubuntu:14.04<br><span class="hljs-comment"># 维护者名字和邮箱</span><br>MAINTAINER ideask&lt;ideask@outlook.com&gt;<br><span class="hljs-comment"># 设置环境变量，使用的xterm是图形界面下virtual terminal的一个实现，应该是有颜色显示吧</span><br>ENV TERM=xterm<br>ENV WORKDIR=/home/BBB/build<br><span class="hljs-comment"># 不使用dash 使用bash | 使用静默安装，全部按默认设置</span><br>RUN <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;dash dash/sh boolean false&quot;</span> | debconf-set-selections \<br><span class="hljs-comment"># 大多数发行版不会包含 /usr/sbin/policy-rc.d 文件，因为这个文件是用于帮助管理员控制哪些包可以在安装、卸载、更新时执行脚本。而在 docker 容器中，大多数 apt-get install 发生在 docker build 阶段，这个阶段如果去启动/停止服务，可能因为一些意外而无法成功并且也没有必要。大多数服务都是在 docker run 或 docker start 时启动/停止。如果你一定要启动/停止服务，可以将 /usr/sbin/policy-rc.d 文件中的返回值改为0，因为后续我们要启动sshd的服务</span><br>    &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;#!/bin/sh\nexit 0&quot;</span> &gt; /usr/sbin/policy-rc.d \<br><span class="hljs-comment"># 不使用dash</span><br>    &amp;&amp; dpkg-reconfigure -p critical dash \<br>    &amp;&amp; apt-get update \<br>    &amp;&amp; apt-get install -y openssh-server git gitk wget xz-utils python dpkg lzma pkg-config libncurses5-dev \<br>       autoconf automake cmake libtool  \<br>    &amp;&amp; apt-get update \<br>    &amp;&amp; apt-get clean \<br><span class="hljs-comment"># 指定新工作组BBB的组ID是1000  -g指定新工作组的ID</span><br>    &amp;&amp; groupadd -g 1000 BBB \<br><span class="hljs-comment"># -u指定用户ID -g指定用户所属工作组 -G指定用户所属附加工作组 -m自动建立用户的登入目录 最后是新用户的名字</span><br>    &amp;&amp; useradd -u 1000 -g 1000 -G sudo -m BBB \<br>    &amp;&amp; mkdir -p <span class="hljs-variable">$WORKDIR</span> \<br><span class="hljs-comment"># 对新用户的目录改变其所属工作组和用户</span><br>    &amp;&amp; chown BBB:BBB <span class="hljs-variable">$WORKDIR</span> \<br><span class="hljs-comment"># 批量更改密码的指令</span><br>    &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;BBB:ideask&quot;</span> | chpasswd \<br>    &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;root:ideask&quot;</span> | chpasswd \<br>    &amp;&amp; rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* \<br>    &amp;&amp; <span class="hljs-built_in">cd</span> <span class="hljs-variable">$WORKDIR</span> <br><span class="hljs-comment"># 创建sshd的运行目录，不然打开服务会出错</span><br>RUN mkdir -p /var/run/sshd<br><span class="hljs-comment"># 允许root连接</span><br>RUN sed -i <span class="hljs-string">&#x27;s/PermitRootLogin without-password/PermitRootLogin yes/g&#x27;</span> /etc/ssh/sshd_config<br><span class="hljs-comment"># 下载gcc交叉编译工具</span><br>RUN <span class="hljs-built_in">cd</span> <span class="hljs-variable">$WORKDIR</span> \<br>    &amp;&amp; wget -c -O gcc.tar.xz https://releases.linaro.org/components/toolchain/binaries/6.5-2018.12/arm-linux-gnueabihf/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf.tar.xz \<br>    &amp;&amp; tar -xf gcc.tar.xz \<br>    &amp;&amp; <span class="hljs-built_in">export</span> CC=`<span class="hljs-built_in">pwd</span>`/gcc-linaro-6.5.0-2018.12-x86_64_arm-linux-gnueabihf/bin/arm-linux-gnueabihf-<br><span class="hljs-comment"># 克隆uboot</span><br>RUN <span class="hljs-built_in">cd</span> <span class="hljs-variable">$WORKDIR</span> \<br>    &amp;&amp; git <span class="hljs-built_in">clone</span> -b v2019.04 https://gitee.com/ideask/u-boot.git --depth=1 \<br>    &amp;&amp; <span class="hljs-built_in">cd</span> u-boot \<br>    &amp;&amp; <span class="hljs-built_in">pwd</span> \<br>    &amp;&amp; ls \<br>    &amp;&amp; git pull --no-edit https://gitee.com/ideask/u-boot-bbb.git v2019.04-bbb.io-am335x<br><span class="hljs-comment"># 克隆kernel</span><br>RUN <span class="hljs-built_in">cd</span> <span class="hljs-variable">$WORKDIR</span> \<br>    &amp;&amp; <span class="hljs-built_in">pwd</span> \<br>    &amp;&amp; ls \<br>    &amp;&amp; git <span class="hljs-built_in">clone</span> https://gitee.com/ideask/ti-linux-kernel-dev.git \<br>    &amp;&amp; <span class="hljs-built_in">cd</span> ti-linux-kernel-dev/ \<br>    &amp;&amp; <span class="hljs-built_in">pwd</span> \<br>    &amp;&amp; ls \<br>    &amp;&amp; git checkout origin/ti-linux-rt-5.10.y -b tmp<br><span class="hljs-comment"># 下载ubuntu20.04LTS-rootfs user：ubuntu  password:temppwd</span><br>RUN <span class="hljs-built_in">cd</span> <span class="hljs-variable">$WORKDIR</span> \<br>    &amp;&amp; wget -c https://rcn-ee.com/rootfs/eewiki/minfs/ubuntu-20.04.2-minimal-armhf-2021-06-20.tar.xz \<br>    &amp;&amp; tar xf ubuntu-20.04.2-minimal-armhf-2021-06-20.tar.xz<br><br><span class="hljs-comment"># 声明要映射的端口号</span><br>EXPOSE  22<br><span class="hljs-comment"># 以守护进程的方式运行sshd</span><br>CMD     [<span class="hljs-string">&quot;/usr/sbin/sshd&quot;</span>, <span class="hljs-string">&quot;-D&quot;</span>]<br>ENV TERM=xterm-256color \<br>    TERMINFO=/lib/terminfo<br><br></code></pre></td></tr></table></figure>
<div id="paginator"></div></div><div id="post-footer"><hr><a href="/2021/08/16/bbb-env-build/">← Prev BeagleBoneBlack开发环境</a><span style="color: #fe2"> | </span><a href="/2021/08/16/ubuntu-server-env-build/">Ubuntu服务器环境搭建 Next →</a><hr></div><div id="bottom-btn"><a id="to-index" href="#post-index" title="index">≡</a><a id="to-top" href="#post-title" title="to top">∧</a></div><div id="Valine"></div><script>new Valine({
 el: '#Valine'
 , appId: ''
 , appKey: ''
 , placeholder: '此条评论委托企鹅物流发送'
})</script></div></article><aside><div id="about"><!--a(href=config.root)#logo--><!--  img(src=asideLogo, alt="Logo")--><h1 id="Dr"><a href="/">Kenny</a></h1><section id="total"><a id="total-archives" href="/archives"><span class="total-title">Archives Total:</span><span class="total-number">4</span></a><div id="total-tags"><span class="total-title">Tags:</span><span class="total-number">4</span></div><div id="total-categories"><span class="total-title">Categories:</span><span class="total-number">4</span></div></section></div><div id="aside-block"><h1>INDEX</h1><div id="post-index"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#dockerfiles%E7%BC%96%E5%86%99"><span class="toc-number">1.</span> <span class="toc-text">dockerfiles编写</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docker-build"><span class="toc-number">2.</span> <span class="toc-text">docker build</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docker-commit"><span class="toc-number">3.</span> <span class="toc-text">docker commit</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docker-images"><span class="toc-number">4.</span> <span class="toc-text">docker images</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#docker-images-history"><span class="toc-number">4.1.</span> <span class="toc-text">docker images history</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docker-ps-docker-ps-a"><span class="toc-number">5.</span> <span class="toc-text">docker ps &#x2F; docker ps -a</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docker-stop"><span class="toc-number">6.</span> <span class="toc-text">docker stop</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docker-start"><span class="toc-number">7.</span> <span class="toc-text">docker start</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docker-exec"><span class="toc-number">8.</span> <span class="toc-text">docker exec</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docker-rm"><span class="toc-number">9.</span> <span class="toc-text">docker rm</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docker-rmi"><span class="toc-number">10.</span> <span class="toc-text">docker rmi</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docker-update"><span class="toc-number">11.</span> <span class="toc-text">docker update</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docker-create"><span class="toc-number">12.</span> <span class="toc-text">docker create</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docker-run"><span class="toc-number">13.</span> <span class="toc-text">docker run</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docker-logs"><span class="toc-number">14.</span> <span class="toc-text">docker logs</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docker%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA%E9%95%9C%E5%83%8F%E6%96%B9%E5%BC%8F"><span class="toc-number">15.</span> <span class="toc-text">docker导入导出镜像方式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E9%9B%86"><span class="toc-number">16.</span> <span class="toc-text">常见问题集</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%EF%BC%9ADockerfile-%E4%B8%AD%E6%89%A7%E8%A1%8C-tar"><span class="toc-number">16.1.</span> <span class="toc-text">解决：Dockerfile 中执行 tar</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BE%8B%E5%AD%90-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAubuntu14%E5%B8%A6%E6%9C%89sshd%E6%9C%8D%E5%8A%A1%E7%9A%84%E5%AE%B9%E5%99%A8%E5%B9%B6%E4%B8%94%E9%83%A8%E7%BD%B2%E5%A5%BD%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83"><span class="toc-number">17.</span> <span class="toc-text">例子-创建一个ubuntu14带有sshd服务的容器并且部署好开发环境</span></a></li></ol></div></div><footer><nobr><span class="text-title">©</span><span class="text-content">2017 to 2021</span></nobr><wbr><nobr><span class="text-title">Email</span><span class="text-content">ideask@outlook.com</span></nobr><wbr><wbr><nobr>Contact me&nbsp;<a href="mailto:ideask@outlook.com">Email&nbsp;</a></nobr><wbr><nobr>Follow me&nbsp;<a target="_blank" rel="noopener" href="https://github.com/ideask">Github&nbsp;</a></nobr><wbr><nobr>or&nbsp;<a target="_blank" rel="noopener" href="https://gitee.com/ideask">Gitee</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/arknights.js"></script><script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/10.1.2/highlight.min.js"></script></body></html>